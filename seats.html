<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Your Seat - Bus Booking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .seat {
            width: 45px;
            height: 45px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
            border: 2px solid;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .seat.available {
            background-color: #f8f9fa;
            border-color: #e9ecef;
            color: #495057;
        }
        
        .seat.available:hover {
            border-color: #fd7e14;
            transform: scale(1.05);
        }
        
        .seat.selected {
            background-color: #fd7e14;
            border-color: #fd7e14;
            color: white;
        }
        
        .seat.booked {
            background-color: #28a745;
            border-color: #28a745;
            color: white;
            cursor: not-allowed;
        }
        
        .bus-layout {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-radius: 20px;
            padding: 24px;
            position: relative;
        }
        
        .driver-section {
              background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-radius: 50%;
            
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
    </style>
    
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <div class="bg-white shadow-sm">
        <div class="flex items-center p-4">
            <button onclick="goBack()" class="text-gray-700 text-md mr-4">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1 class="text-md font-semibold text-gray-800">Select Your Seat</h1>
        </div>
    </div>

    <!-- Bus Info Section -->
    <div class="p-2">
        <div class="bg-white p-2 rounded-lg">
            <div class="flex justify-between items-start">
                <div>
                    <p id="bus-route" class="text-sm font-semibold text-gray-800">Route</p>
                    <p class="text-sm font-semibold text-gray-700" id="busTime">7:45 PM</p>
                </div>
                <div class="text-right">
                   <h2 class="text-sm font-semibold text-gray-800" id="busName">Ena Transport</h2>
                    <p class="text-sm text-gray-600">Type: <span class="font-medium" id="busType">AC</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Seat Legend -->
    <div class="px-2 pb-2">
        <div class="bg-white p-2 rounded-lg">
            <div class="flex justify-around items-center">
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-gray-100 border-2 border-gray-300 rounded"></div>
                    <span class="text-xs text-gray-600">Available</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-green-500 rounded"></div>
                    <span class="text-xs text-gray-600">Booked</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-orange-500 rounded"></div>
                    <span class="text-xs text-gray-600">Selected</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Bus Layout -->
    <div class="px-2">
        <div class="bus-layout">
            <!-- Driver Section -->
      <div class="flex justify-end mb-3 mr-9">
    <div class="driver-section">
        <!-- Inline SVG Steering Wheel Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
            <line x1="12" y1="3" x2="12" y2="9" stroke="currentColor" stroke-width="2"/>
            <line x1="12" y1="15" x2="12" y2="21" stroke="currentColor" stroke-width="2"/>
            <line x1="3" y1="12" x2="9" y2="12" stroke="currentColor" stroke-width="2"/>
            <line x1="15" y1="12" x2="21" y2="12" stroke="currentColor" stroke-width="2"/>
        </svg>
    </div>
</div>

            <!-- Seats Grid -->
            <div class="space-y-4">
                <!-- Row A -->
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="A1">A1</button>
                        <button class="seat available" data-seat="A2">A2</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat booked" data-seat="A3" disabled>A3</button>
                        <button class="seat booked" data-seat="A4" disabled>A4</button>
                    </div>
                </div>

                <!-- Row B -->
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat selected" data-seat="B1">B1</button>
                        <button class="seat selected" data-seat="B2">B2</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="B3">B3</button>
                        <button class="seat available" data-seat="B4">B4</button>
                    </div>
                </div>

                <!-- Row C -->
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="C1">C1</button>
                        <button class="seat available" data-seat="C2">C2</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="C3">C3</button>
                        <button class="seat available" data-seat="C4">C4</button>
                    </div>
                </div>

                <!-- Row D -->
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat booked" data-seat="D1" disabled>D1</button>
                        <button class="seat booked" data-seat="D2" disabled>D2</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat booked" data-seat="D3" disabled>D3</button>
                        <button class="seat booked" data-seat="D4" disabled>D4</button>
                    </div>
                </div>

                <!-- Row E -->
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="E1">E1</button>
                        <button class="seat available" data-seat="E2">E2</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="E3">E3</button>
                        <button class="seat available" data-seat="E4">E4</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Selected Seats Info -->
    <div class="p-4" id="selectedInfo">
        <div class="bg-white p-4 rounded-lg">
            <div class="flex justify-between items-center">
                <div>
                    <p class="text-sm text-gray-600">Selected Seats: <span id="selectedSeats" class="font-medium text-gray-800">B1, B2</span></p>
                    <p class="text-sm text-gray-600">Total Seats: <span id="seatCount" class="font-medium text-gray-800">2</span></p>
                </div>
                <div class="text-right">
                    <p class="text-sm font-bold text-green-600">â‚¹ <span id="totalAmount">7200</span></p>
                </div>
            </div>
        </div> 
    </div>

    <!-- Continue Button -->
    <div class="p-4 pb-8">
        <button onclick="proceedToBooking()" class="w-full bg-green-600 text-white font-semibold py-2 rounded-lg transition-colors duration-200" id="continueBtn">
            Select Boarding & Dropping Point
        </button>
    </div>

    <script>
        // Seat selection functionality
let selectedSeats = ['B1', 'B2']; // Initially selected seats
let seatPrice = 3600; // Default price
const MAX_SEATS = 10;

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    loadBusDataFromURL();
    updateDisplay();
    attachSeatListeners();
});

// Load bus data from URL parameters
function loadBusDataFromURL() {
    const urlParams = new URLSearchParams(window.location.search);
    
    // Get bus data from URL parameters
    const busName = urlParams.get('name') || 'Ena Transport';
    const busTime = urlParams.get('time') || '7:45 PM';
    const busType = urlParams.get('type') || 'AC (6)';
    const price = urlParams.get('price') || '3600';
    
    // Update the page with dynamic data

    document.getElementById('bus-route').textContent = (localStorage.getItem('fromCity') || 'Bhubaneswar') + ' - ' + (localStorage.getItem('toCity') || 'Cuttack');
    document.getElementById('busName').textContent = busName;
    document.getElementById('busTime').textContent = busTime;
    document.getElementById('busType').textContent = busType;
    
    // Update seat price for calculations
    seatPrice = parseInt(price);
}

// Attach click listeners to all available seats
function attachSeatListeners() {
    const seats = document.querySelectorAll('.seat.available, .seat.selected');
    seats.forEach(seat => {
        seat.addEventListener('click', function() {
            toggleSeat(this.dataset.seat);
        });
    });
}

// Toggle seat selection
function toggleSeat(seatId) {
    const seatButton = document.querySelector(`[data-seat="${seatId}"]`);
    
    if (seatButton.classList.contains('selected')) {
        // Deselect seat
        seatButton.classList.remove('selected');
        seatButton.classList.add('available');
        selectedSeats = selectedSeats.filter(seat => seat !== seatId);
    } else if (seatButton.classList.contains('available')) {
        // Check seat limit
        if (selectedSeats.length >= MAX_SEATS) {
            showAlert(`Maximum ${MAX_SEATS} seats can be selected!`);
            return;
        }
        
        // Select seat
        seatButton.classList.remove('available');
        seatButton.classList.add('selected');
        selectedSeats.push(seatId);
    }
    
    updateDisplay();
}

// Update display with current selection
function updateDisplay() {
    const selectedSeatsElement = document.getElementById('selectedSeats');
    const seatCountElement = document.getElementById('seatCount');
    const totalAmountElement = document.getElementById('totalAmount');
    const continueBtn = document.getElementById('continueBtn');
    
    // Update selected seats display
    if (selectedSeats.length > 0) {
        selectedSeatsElement.textContent = selectedSeats.sort().join(', ');
        seatCountElement.textContent = selectedSeats.length;
        
        // Calculate total price
        const totalPrice = selectedSeats.length * seatPrice;
        totalAmountElement.textContent = totalPrice.toLocaleString();
        
        // Enable continue button
        continueBtn.disabled = false;
        continueBtn.classList.remove('opacity-50', 'cursor-not-allowed');
    } else {
        selectedSeatsElement.textContent = 'None';
        seatCountElement.textContent = '0';
        totalAmountElement.textContent = '0';
        
        // Disable continue button
        continueBtn.disabled = true;
        continueBtn.classList.add('opacity-50', 'cursor-not-allowed');
    }
}

// Go back to results page
function goBack() {
    window.history.back();
}

// Proceed to booking
// Proceed to boarding page
function proceedToBooking() {
    if (selectedSeats.length === 0) {
        showAlert('Please select at least one seat to continue!');
        return;
    }
    
    const urlParams = new URLSearchParams(window.location.search);
    const busName = urlParams.get('name') || 'Ena Transport';
    const busTime = urlParams.get('time') || '7:45 PM';
    const busType = urlParams.get('type') || 'AC (6)';
    const totalPrice = selectedSeats.length * seatPrice;
    
    // Navigate to boarding page with all data
    const boardingUrl = `boarding.html?busName=${encodeURIComponent(busName)}&busTime=${encodeURIComponent(busTime)}&busType=${encodeURIComponent(busType)}&seatPrice=${seatPrice}&selectedSeats=${encodeURIComponent(selectedSeats.join(', '))}&totalPrice=${totalPrice}`;
    
    window.location.href = boardingUrl;
}


// Show alert message
function showAlert(message) {
    const overlay = document.createElement('div');
    overlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
    
    const alertBox = document.createElement('div');
    alertBox.className = 'bg-white p-6 rounded-lg shadow-lg max-w-sm w-full';
    
    const messageText = document.createElement('p');
    messageText.className = 'text-gray-800 mb-4 whitespace-pre-line text-sm';
    messageText.textContent = message;
    
    const okButton = document.createElement('button');
    okButton.className = 'w-full bg-orange-500 hover:bg-orange-600 text-white font-semibold py-3 rounded-lg transition-colors duration-200';
    okButton.textContent = 'OK';
    okButton.onclick = () => document.body.removeChild(overlay);
    
    alertBox.appendChild(messageText);
    alertBox.appendChild(okButton);
    overlay.appendChild(alertBox);
    document.body.appendChild(overlay);
}

    </script>
</body>
</html>