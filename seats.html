<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Your Seat - Bus Booking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @media (min-width: 768px) {
    body {
        display: grid;
        place-items: center;
    }
    
    body > * {
        max-width: 375px;
        width: 100%;
        border-left: 1px solid #e5e7eb;
        border-right: 1px solid #e5e7eb;
    }
}
        .seat {
            width: 45px;
            height: 45px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
            border: 2px solid;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .seat.available {
            background-color: #f8f9fa;
            border-color: #e9ecef;
            color: #495057;
        }
        
        .seat.available:hover {
            border-color: #fd7e14;
            transform: scale(1.05);
        }
        
        .seat.selected {
            background-color: #fd7e14;
            border-color: #fd7e14;
            color: white;
        }
        
        .seat.booked {
            background-color: #28a745;
            border-color: #28a745;
            color: white;
            cursor: not-allowed;
        }
        
        .bus-layout {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-radius: 20px;
            padding: 24px;
            position: relative;
        }
        
        .driver-section {
              background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-radius: 50%;
            
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .sleeper .seat {
            width: 45px;
            height: 100px;
            border-radius: 10px;
        }

    </style>
    
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <div class="bg-white shadow-sm">
        <div class="flex items-center p-4">
            <button onclick="goBack()" class="text-gray-700 text-md mr-4">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1 class="text-md font-semibold text-gray-800">Select Your Seat</h1>
        </div>
    </div>

    <!-- Bus Info Section -->
    <div class="px-2">
        <div class="bg-white p-2 rounded-lg">
            <div class="flex justify-between items-start">
                <div>
                    <p id="bus-route" class="text-sm font-semibold text-gray-800">Route</p>
                    <p class="text-sm font-semibold text-gray-700" id="busTime">7:45 PM</p>
                </div>
                <div class="text-right">
                   <h2 class="text-sm font-semibold text-gray-800" id="busName">Ena Transport</h2>
                    <p class="text-sm text-gray-600">Type: <span class="font-medium" id="busType">AC</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Seat Legend -->
    <div class="px-2 pb-2">
        <div class="bg-white p-3 rounded-lg">
            <div class="flex justify-around items-center">
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-gray-100 border-2 border-gray-300 rounded"></div>
                    <span class="text-xs text-gray-600">Available</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-green-500 rounded"></div>
                    <span class="text-xs text-gray-600">Booked</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-4 h-4 bg-orange-500 rounded"></div>
                    <span class="text-xs text-gray-600">Selected</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Bus Layout -->
    <div class="px-2">
        <div class="bus-layout">
            <!-- Driver Section -->
<div class="flex justify-between items-center mb-3 mr-9 ml-1">

    <button onclick="toggleLayout()" 
        class="flex items-center gap-2 py-1 text-gray-500 text-sm font-semibold
               rounded-lg transition ring-2 ring-gray-600
               transition-all duration-200 p-1">
        Upper Berth
        <svg xmlns="http://www.w3.org/2000/svg" 
              width="16" height="16" 
              viewBox="0 0 24 24" 
              fill="none" 
              stroke="currentColor" 
              stroke-width="2" 
              stroke-linecap="round" 
              stroke-linejoin="round"
              class="text-gray-500 relative top-[1px]">
            <polyline points="23 4 23 10 17 10"></polyline>
            <polyline points="1 20 1 14 7 14"></polyline>
            <path d="M3.51 9a9 9 0 0 1 14.13-3.36L23 10"></path>
            <path d="M20.49 15a9 9 0 0 1-14.13 3.36L1 14"></path>
        </svg>
    </button>


       <!-- Right side steering wheel icon -->
    <div class="driver-section">
       <svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" viewBox="0 0 40 40" fill="none">
       <path d="M38.7222 18.521C39.9065 42.9616 2.97263 45.1572 1.278 20.7139C0.0937346 
       -3.7255 37.0276 -5.92111 38.7222 18.521ZM6.85361 14.9134H33.1466C29.84 2.85115 
       10.1587 2.85589 6.85361 14.9134ZM17.6142 33.3626C17.6854 26.7541 13.022 19.8117 
       5.99136 19.5594C5.87927 26.7284 11.5146 32.5365 17.6142 33.3626ZM34.0097 
       19.6143C26.8539 19.6963 22.5045 26.8279 22.2997 33.3742C28.4857 32.5365 34.121 26.7284
       34.0097 19.6143ZM22.338 19.6081C22.3545 16.579 17.6195 16.6012 17.6622 19.6281C17.6457 
       22.6571 22.3808 22.6348 22.338 19.6081Z" fill="#6B7280">
       </path>
       </svg>
    </div>
</div>

            <!-- Seats Grid -->
            <div id="seaterLayout" class="space-y-4">
                <!-- Row A -->
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="L1">L1</button>
                        <button class="seat available" data-seat="L2">L2</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat booked" data-seat="L3" disabled>L3</button>
                        <button class="seat booked" data-seat="L4" disabled>L4</button>
                    </div>
                </div>

                <!-- Row B -->
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="L5">L5</button>
                        <button class="seat available" data-seat="L6">L6</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="L7">L7</button>
                        <button class="seat available" data-seat="L8">L8</button>
                    </div>
                </div>

                <!-- Row C -->
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="L9">L9</button>
                        <button class="seat available" data-seat="L10">L10</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="L11">L11</button>
                        <button class="seat available" data-seat="L12">L12</button>
                    </div>
                </div>

                <!-- Row D -->
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat booked" data-seat="L13" disabled>L13</button>
                        <button class="seat booked" data-seat="L14" disabled>L14</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat booked" data-seat="L15" disabled>L15</button>
                        <button class="seat booked" data-seat="L16" disabled>L16</button>
                    </div>
                </div>

                <!-- Row E -->
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="E17">E17</button>
                        <button class="seat available" data-seat="E18">E18</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="19">L19</button>
                        <button class="seat available" data-seat="20">E20</button>
                    </div>
                </div>
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="L21">L21</button>
                        <button class="seat available" data-seat="L22">L22</button>
                    </div>
                    <div class="flex space-x-3">
                        <button class="seat available" data-seat="L23">L23</button>
                        <button class="seat available" data-seat="L24">L24</button>
                    </div>
                </div>
            </div>

            <!-- Sleeper layout -->
<div id="sleeperLayout" class="sleeper space-y-4" style="display:none;">
  <div class="flex justify-between">
    <div class="flex space-x-3">
      <button class="seat available" data-seat="U1">U1</button>
      <button class="seat available" data-seat="U2">U2</button>
    </div>
    <div class="flex space-x-3">
      <button class="seat available" data-seat="U3">U3</button>
      <button class="seat available" data-seat="U4">U4</button>
    </div>
  </div>
  <div class="flex justify-between">
    <div class="flex space-x-3">
      <button class="seat booked" disabled>U5</button>
      <button class="seat available" data-seat="U6">U6</button>
    </div>
    <div class="flex space-x-3">
      <button class="seat available" data-seat="U7">U7</button>
      <button class="seat booked" disabled>U8</button>
    </div>
  </div>
  <div class="flex justify-between">
    <div class="flex space-x-3">
      <button class="seat booked" disabled>U9</button>
      <button class="seat available" data-seat="U10">U10</button>
    </div>
    <div class="flex space-x-3">
      <button class="seat available" data-seat="U11">U11</button>
      <button class="seat available" data-seat="U12">U12</button>
    </div>
  </div>
</div>

        </div>
    </div>
  
    <!-- Selected Seats Info -->
    <div class="p-4" id="selectedInfo">
        <div class="bg-white p-4 rounded-lg">
            <div class="flex justify-between items-center">
                <div>
                    <p class="text-sm text-gray-600">Selected Seats: <span id="selectedSeats" class="font-medium text-gray-800">B1, B2</span></p>
                    <p class="text-sm text-gray-600">Total Seats: <span id="seatCount" class="font-medium text-gray-800">2</span></p>
                </div>
                <div class="text-right">
                    <p class="text-sm font-bold text-green-600">â‚¹ <span id="totalAmount">7200</span></p>
                </div>
            </div>
        </div> 
    </div>

    <!-- Continue Button -->
    <div class="p-4 pb-8">
        <button onclick="proceedToBooking()" class="w-full bg-green-600 text-white font-semibold py-2 rounded-lg transition-colors duration-200" id="continueBtn">
            Select Boarding & Dropping Point
        </button>
    </div>

    <script>
        // Seat selection functionality
let selectedSeats = []; // Initially selected seats
let seatPrice = 3600; // Default price
const MAX_SEATS = 10;

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    loadBusDataFromURL();
    updateDisplay();
    attachSeatListeners();
});

// Load bus data from URL parameters
function loadBusDataFromURL() {
    const urlParams = new URLSearchParams(window.location.search);
    
    // Get bus data from URL parameters
    const busName = urlParams.get('name') || 'Ena Transport';
    const busTime = urlParams.get('time') || '7:45 PM';
    const busType = urlParams.get('type') || 'AC (6)';
    const price = urlParams.get('price') || '3600';
    
    // Update the page with dynamic data

    document.getElementById('bus-route').textContent = (localStorage.getItem('fromCity') || 'Bhubaneswar') + ' - ' + (localStorage.getItem('toCity') || 'Cuttack');
    document.getElementById('busName').textContent = busName;
    document.getElementById('busTime').textContent = busTime;
    document.getElementById('busType').textContent = busType;
    
    // Update seat price for calculations
    seatPrice = parseInt(price);
}

// Attach click listeners to all available seats
function attachSeatListeners() {
    const seats = document.querySelectorAll('.seat.available, .seat.selected');
    seats.forEach(seat => {
        seat.addEventListener('click', function() {
            toggleSeat(this.dataset.seat);
        });
    });
}

// Toggle seat selection
function toggleSeat(seatId) {
    const seatButton = document.querySelector(`[data-seat="${seatId}"]`);
    
    if (seatButton.classList.contains('selected')) {
        // Deselect seat
        seatButton.classList.remove('selected');
        seatButton.classList.add('available');
        selectedSeats = selectedSeats.filter(seat => seat !== seatId);
    } else if (seatButton.classList.contains('available')) {
        // Check seat limit
        if (selectedSeats.length >= MAX_SEATS) {
            showAlert(`Maximum ${MAX_SEATS} seats can be selected!`);
            return;
        }
        
        // Select seat
        seatButton.classList.remove('available');
        seatButton.classList.add('selected');
        selectedSeats.push(seatId);
    }
    
    updateDisplay();
}

// Update display with current selection
function updateDisplay() {
    const selectedSeatsElement = document.getElementById('selectedSeats');
    const seatCountElement = document.getElementById('seatCount');
    const totalAmountElement = document.getElementById('totalAmount');
    const continueBtn = document.getElementById('continueBtn');
    
    // Update selected seats display
    if (selectedSeats.length > 0) {
        selectedSeatsElement.textContent = selectedSeats.sort().join(', ');
        seatCountElement.textContent = selectedSeats.length;
        
        // Calculate total price
        const totalPrice = selectedSeats.length * seatPrice;
        totalAmountElement.textContent = totalPrice.toLocaleString();
        
        // Enable continue button
        continueBtn.disabled = false;
        continueBtn.classList.remove('opacity-50', 'cursor-not-allowed');
    } else {
        selectedSeatsElement.textContent = 'None';
        seatCountElement.textContent = '0';
        totalAmountElement.textContent = '0';
        
        // Disable continue button
        continueBtn.disabled = true;
        continueBtn.classList.add('opacity-50', 'cursor-not-allowed');
    }
}

// Go back to results page
function goBack() {
    window.history.back();
}

// Proceed to booking
// Proceed to boarding page
function proceedToBooking() {
    if (selectedSeats.length === 0) {
        showAlert('Please select at least one seat to continue!');
        return;
    }
    
    const urlParams = new URLSearchParams(window.location.search);
    const busName = urlParams.get('name') || 'Ena Transport';
    const busTime = urlParams.get('time') || '7:45 PM';
    const busType = urlParams.get('type') || 'AC (6)';
    const totalPrice = selectedSeats.length * seatPrice;
    
    // Navigate to boarding page with all data
    const boardingUrl = `boarding.html?busName=${encodeURIComponent(busName)}&busTime=${encodeURIComponent(busTime)}&busType=${encodeURIComponent(busType)}&seatPrice=${seatPrice}&selectedSeats=${encodeURIComponent(selectedSeats.join(', '))}&totalPrice=${totalPrice}`;
    
    window.location.href = boardingUrl;
}


// Show alert message
function showAlert(message) {
    const overlay = document.createElement('div');
    overlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
    
    const alertBox = document.createElement('div');
    alertBox.className = 'bg-white p-6 rounded-lg shadow-lg max-w-sm w-full';
    
    const messageText = document.createElement('p');
    messageText.className = 'text-gray-800 mb-4 whitespace-pre-line text-sm';
    messageText.textContent = message;
    
    const okButton = document.createElement('button');
    okButton.className = 'w-full bg-orange-500 hover:bg-orange-600 text-white font-semibold py-3 rounded-lg transition-colors duration-200';
    okButton.textContent = 'OK';
    okButton.onclick = () => document.body.removeChild(overlay);
    
    alertBox.appendChild(messageText);
    alertBox.appendChild(okButton);
    overlay.appendChild(alertBox);
    document.body.appendChild(overlay);
}

function toggleLayout() {
  const seater = document.getElementById('seaterLayout');
  const sleeper = document.getElementById('sleeperLayout');
  const btn = document.querySelector('button[onclick="toggleLayout()"]');

  if (seater.style.display !== 'none') {
    seater.style.display = 'none';
    sleeper.style.display = 'block';
    btn.innerHTML = `Lower Berth 
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" 
       stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
       class="text-gray-500 relative top-[1px]">
    <polyline points="23 4 23 10 17 10"></polyline>
    <polyline points="1 20 1 14 7 14"></polyline>
    <path d="M3.51 9a9 9 0 0 1 14.13-3.36L23 10"></path>
    <path d="M20.49 15a9 9 0 0 1-14.13 3.36L1 14"></path>
  </svg>`;

  } else {
    seater.style.display = 'block';
    sleeper.style.display = 'none';
   btn.innerHTML = `Upper Berth 
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" 
       stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
       class="text-gray-500 relative top-[1px]">
    <polyline points="23 4 23 10 17 10"></polyline>
    <polyline points="1 20 1 14 7 14"></polyline>
    <path d="M3.51 9a9 9 0 0 1 14.13-3.36L23 10"></path>
    <path d="M20.49 15a9 9 0 0 1-14.13 3.36L1 14"></path>
  </svg>`;

  }
}
    </script>
</body>
</html>
